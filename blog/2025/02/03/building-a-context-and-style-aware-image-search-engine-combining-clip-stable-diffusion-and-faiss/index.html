<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Generative AI Consultant"><meta name=author content="['me']"><link href=https://christhomas.co.uk/blog/2025/02/03/building-a-context-and-style-aware-image-search-engine-combining-clip-stable-diffusion-and-faiss/ rel=canonical><link href=../../../01/26/how-to-sleep-soundly-when-using-llms-in-production-evals/ rel=prev><link rel=icon href=../../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.48"><title>Building a Context and Style Aware Image Search Engine: Combining CLIP, Stable Diffusion, and FAISS - Chris Thomas</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../assets/_mkdocstrings.css><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-YY66S4LNV5"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-YY66S4LNV5",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-YY66S4LNV5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="Building a Context and Style Aware Image Search Engine: Combining CLIP, Stable Diffusion, and FAISS - Chris Thomas"><meta property=og:description content="Generative AI Consultant"><meta property=og:image content=https://christhomas.co.uk/assets/images/social/blog/posts/Building-a-Context-Aware-Image-Search-Engine.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://christhomas.co.uk/blog/2025/02/03/building-a-context-and-style-aware-image-search-engine-combining-clip-stable-diffusion-and-faiss/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Building a Context and Style Aware Image Search Engine: Combining CLIP, Stable Diffusion, and FAISS - Chris Thomas"><meta name=twitter:description content="Generative AI Consultant"><meta name=twitter:image content=https://christhomas.co.uk/assets/images/social/blog/posts/Building-a-Context-Aware-Image-Search-Engine.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#building-a-context-and-style-aware-image-search-engine-combining-clip-stable-diffusion-and-faiss class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../.. title="Chris Thomas" class="md-header__button md-logo" aria-label="Chris Thomas" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Chris Thomas </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Building a Context and Style Aware Image Search Engine: Combining CLIP, Stable Diffusion, and FAISS </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../../ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../.. title="Chris Thomas" class="md-nav__button md-logo" aria-label="Chris Thomas" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Chris Thomas </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../archive/2025/ class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2023/ class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2021/ class=md-nav__link> <span class=md-ellipsis> 2021 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2020/ class=md-nav__link> <span class=md-ellipsis> 2020 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2019/ class=md-nav__link> <span class=md-ellipsis> 2019 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-1-search-by-content-relevance class=md-nav__link> <span class=md-ellipsis> Example 1: Search by content relevance </span> </a> </li> <li class=md-nav__item> <a href=#example-2-search-by-content-relevance-and-also-by-style class=md-nav__link> <span class=md-ellipsis> Example 2: Search by content relevance and also by style </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#core-technologies class=md-nav__link> <span class=md-ellipsis> Core Technologies </span> </a> <nav class=md-nav aria-label="Core Technologies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hybrid-neural-search-clip-stable-diffusion class=md-nav__link> <span class=md-ellipsis> Hybrid Neural Search (CLIP + Stable Diffusion) </span> </a> <nav class=md-nav aria-label="Hybrid Neural Search (CLIP + Stable Diffusion)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#clip-features class=md-nav__link> <span class=md-ellipsis> CLIP Features: </span> </a> </li> <li class=md-nav__item> <a href=#stable-diffusion-components class=md-nav__link> <span class=md-ellipsis> Stable Diffusion Components: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#faiss-facebook-ai-similarity-search class=md-nav__link> <span class=md-ellipsis> FAISS (Facebook AI Similarity Search) </span> </a> </li> <li class=md-nav__item> <a href=#fasthtml-and-monsterui class=md-nav__link> <span class=md-ellipsis> FastHTML and MonsterUI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-features class=md-nav__link> <span class=md-ellipsis> Key Features </span> </a> <nav class=md-nav aria-label="Key Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ai-powered-query-suggestions class=md-nav__link> <span class=md-ellipsis> AI-Powered Query Suggestions </span> </a> <nav class=md-nav aria-label="AI-Powered Query Suggestions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-smart-query-generation class=md-nav__link> <span class=md-ellipsis> 1. Smart Query Generation </span> </a> </li> <li class=md-nav__item> <a href=#2-clip-aware-and-style-aware-formatting class=md-nav__link> <span class=md-ellipsis> 2. CLIP-Aware and Style-Aware Formatting </span> </a> </li> <li class=md-nav__item> <a href=#3-interactive-refinement class=md-nav__link> <span class=md-ellipsis> 3. Interactive Refinement </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#multi-model-search class=md-nav__link> <span class=md-ellipsis> Multi-Model Search </span> </a> <nav class=md-nav aria-label="Multi-Model Search"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-content-search-clip class=md-nav__link> <span class=md-ellipsis> 1. Content Search (CLIP) </span> </a> </li> <li class=md-nav__item> <a href=#2-style-search-stable-diffusion class=md-nav__link> <span class=md-ellipsis> 2. Style Search (Stable Diffusion) </span> </a> </li> <li class=md-nav__item> <a href=#3-location-awareness class=md-nav__link> <span class=md-ellipsis> 3. Location Awareness </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#similar-image-finding class=md-nav__link> <span class=md-ellipsis> Similar Image Finding </span> </a> <nav class=md-nav aria-label="Similar Image Finding"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-dual-similarity-analysis class=md-nav__link> <span class=md-ellipsis> 1. Dual Similarity Analysis </span> </a> </li> <li class=md-nav__item> <a href=#2-location-integration class=md-nav__link> <span class=md-ellipsis> 2. Location Integration </span> </a> </li> <li class=md-nav__item> <a href=#3-combined-scoring class=md-nav__link> <span class=md-ellipsis> 3. Combined Scoring </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../../../../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2025-02-03 00:00:00+00:00" class=md-ellipsis>2025/02/03</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 7 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <h1 id=building-a-context-and-style-aware-image-search-engine-combining-clip-stable-diffusion-and-faiss>Building a Context and Style Aware Image Search Engine: Combining CLIP, Stable Diffusion, and FAISS<a class=headerlink href=#building-a-context-and-style-aware-image-search-engine-combining-clip-stable-diffusion-and-faiss title="Permanent link">&para;</a></h1> <p>This is a demonstration of what is possible with rapid prototyping and iterative refinement using AI dialogue engineering tools.</p> <p>Modern image search needs to go beyond simple metadata and tags. This application demonstrates how to build a sophisticated image search engine that understands natural language, visual content, artistic styles, and geographical context. Users can search their image collections using plain English descriptions, find visually and stylistically similar images, and even combine location data with visual similarity. Once models are downloaded, this search engine runs completely locally without the need for resources, APIs or models in the cloud.</p> <!-- more --> <!-- 

How I built a context-aware image search engine that combines CLIP and Stable Diffusion
This project demonstrates the power of modern rapid prototyping with AI tools. In just a short development cycle, I was able to create a sophisticated search engine that:

Understands both image content AND artistic style
Handles and optimizes natural language queries like "sunset over mountains in van gogh style"
Integrates location data for geographic context
Runs completely locally - no cloud or API dependencies

The key was iterative refinement using AI tools to speed up development. Each iteration added capabilities while keeping the architecture clean and maintainable.

Check out the full technical walkthrough here: 

--> <p>What makes this search engine special is its dual-model approach to understanding context and style. For example, you can search for "sunset over mountains in van gogh style" and it will find relevant images that match both the content and artistic style, even if they weren't explicitly tagged with those terms. You can then adjust the search by adding more terms like "with cypress trees" or "in Switzerland" and adjust how much weight to give to each query criteria.</p> <p>Using FAISS allows the searching of huge quantities of images almost instantly, once the images have been indexed. My experiments have been on dataset collection of 10,000 images, although this would scale at least an order of magnitude higher.</p> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <p>These examples are searching my local collection of photos and images.</p> <h3 id=example-1-search-by-content-relevance>Example 1: Search by content relevance<a class=headerlink href=#example-1-search-by-content-relevance title="Permanent link">&para;</a></h3> <p>Enter a search term in plain English:</p> <p><img alt="Enter a search term in plain English" src=../../../../search/step1.png></p> <p>The search term is expanded into possible optimized search terms and weighting, which can be added to the search:</p> <p><img alt="Enter a search term in plain English" src=../../../../search/step2.png></p> <p>Additional search queries can be added, for example a location:</p> <p><img alt="Additional search queries" src=../../../../search/step3.png></p> <p>Search terms can have weightings adjusted:</p> <p><img alt="Search terms can have weightings adjusted" src=../../../../search/step4.png></p> <p>Results, showing a combined location and visual similarity score. Also, a distance where the images contain location EXIF data.</p> <p><img alt=Results src=../../../../search/step5.png></p> <p>The search can be expanded with "Find Nearby Similar" button, which finds photos with similar content that were taken nearby where the images contain location EXIF data.</p> <p><img alt="Nearby similar images" src=../../../../search/step6-similar-nearby.png></p> <p>Alternatively one or more images can be selected to expand the search to images with similar content to them:</p> <p><img alt="Similar images" src=../../../../search/step7-similar.png></p> <p>Results from selecting two images as a reference for similarity:</p> <p><img alt="Similar images results" src=../../../../search/step8-similar-results.png></p> <h3 id=example-2-search-by-content-relevance-and-also-by-style>Example 2: Search by content relevance and also by style<a class=headerlink href=#example-2-search-by-content-relevance-and-also-by-style title="Permanent link">&para;</a></h3> <p>The search for "van gogh style sunset" is expanded into optimized queries and one selected.</p> <p><img alt="Content relevance and style" src=../../../../search/step-s1.png></p> <p>Using the Hybrid Search (CLIP and SD), the search results are based on both content relevance and Stable Diffusion style.</p> <p><img alt="Content relevance and style results" src=../../../../search/step-s2.png></p> <h2 id=core-technologies>Core Technologies<a class=headerlink href=#core-technologies title="Permanent link">&para;</a></h2> <p><img alt="Diagram showing components and flow" src=../../../../search/diagram.png></p> <h3 id=hybrid-neural-search-clip-stable-diffusion>Hybrid Neural Search (CLIP + Stable Diffusion)<a class=headerlink href=#hybrid-neural-search-clip-stable-diffusion title="Permanent link">&para;</a></h3> <p>This search engine leverages two powerful AI models working in tandem. It uses the <code>ViT-B/16</code> variant of CLIP and components from Stable Diffusion v1.4, offering an excellent balance between performance and resource usage.</p> <h4 id=clip-features>CLIP Features:<a class=headerlink href=#clip-features title="Permanent link">&para;</a></h4> <ul> <li><strong>Architecture</strong>: Vision Transformer (ViT) with a 16x16 patch size</li> <li><strong>Input Resolution</strong>: 224x224 pixels</li> <li><strong>Embedding Dimension</strong>: 512</li> <li><strong>Model Size</strong>: ~150M parameters</li> <li><strong>Performance</strong>: 68.3% zero-shot ImageNet accuracy</li> <li><strong>Strengths</strong>: General object and scene recognition</li> </ul> <h4 id=stable-diffusion-components>Stable Diffusion Components:<a class=headerlink href=#stable-diffusion-components title="Permanent link">&para;</a></h4> <ul> <li><strong>VAE</strong>: For efficient image encoding</li> <li><strong>CLIP Text Encoder</strong>: Specialized in artistic style understanding</li> <li><strong>Embedding Dimension</strong>: 512 (matched to CLIP)</li> <li><strong>Strengths</strong>: Artistic style and aesthetic comprehension</li> </ul> <p>When you search for "sunset over mountains in van gogh style":</p> <ol> <li>CLIP converts the content aspects ("sunset over mountains") into a high-dimensional vector</li> <li>SD's text encoder processes the style aspects ("van gogh style")</li> <li>Both image and text are projected into their respective 512-dimensional embedding spaces</li> <li>The system combines scores from both models with configurable weights</li> <li>Results reflect both content relevance and style matching</li> </ol> <p>This combination was chosen because:</p> <ul> <li>It is fast enough for real-time search</li> <li>Small enough to run on consumer GPUs</li> <li>CLIP excels at understanding concrete concepts</li> <li>Stable Diffusion components excel at artistic style comprehension</li> <li>Efficient memory usage when processing batches</li> </ul> <p>The real magic happens when combining multiple searches - we can mathematically combine these vectors with different weights to find images that match multiple criteria simultaneously.</p> <h3 id=faiss-facebook-ai-similarity-search>FAISS (Facebook AI Similarity Search)<a class=headerlink href=#faiss-facebook-ai-similarity-search title="Permanent link">&para;</a></h3> <p>These models provide powerful embeddings, although searching through them efficiently requires sophisticated indexing. This implementation uses dual FAISS indices:</p> <p><strong>Dual IndexFlatIP</strong>: Simple but effective exact search indices</p> <ul> <li>One for CLIP embeddings (512 dimensions)</li> <li>One for Stable Diffusion embeddings (512 dimensions)</li> <li>Optimized for cosine similarity search</li> <li>Good performance for collections up to ~100k images</li> <li>Full indices loaded into memory for fast searches</li> </ul> <p><strong>Storage Features</strong>:</p> <ul> <li>Separate persistent storage for each model</li> <li>Simple JSON metadata storage</li> <li>Fast load and save operations</li> </ul> <p><strong>Performance Features</strong>:</p> <ul> <li>Batch processing for efficient index updates</li> <li>Exact similarity search (no approximation)</li> <li>Support for incremental updates</li> </ul> <p>Memory-mapped file support is available for handling large collections if needed.</p> <h3 id=fasthtml-and-monsterui>FastHTML and MonsterUI<a class=headerlink href=#fasthtml-and-monsterui title="Permanent link">&para;</a></h3> <p>The user interface is built using FastHTML, a Python framework for server-rendered applications. This is enhanced with MonsterUI components combining the simplicity of FastHTML with the power of TailwindCSS. This combination provides:</p> <ul> <li>Real-time search results without page refreshes</li> <li>Responsive grid layout that adapts to screen size</li> <li>Smooth loading states and transitions</li> <li>Modal image previews</li> <li>Interactive weight adjustments for both models</li> <li>Style-specific UI controls for artistic searches</li> </ul> <p>The UI is specifically designed to handle the dual-model approach:</p> <ul> <li>Visual indicators for which model found each match</li> <li>Preview thumbnails that highlight artistic elements</li> <li>Intuitive sliders for balancing model influence</li> </ul> <h2 id=key-features>Key Features<a class=headerlink href=#key-features title="Permanent link">&para;</a></h2> <h3 id=ai-powered-query-suggestions>AI-Powered Query Suggestions<a class=headerlink href=#ai-powered-query-suggestions title="Permanent link">&para;</a></h3> <p>One of the most powerful features is the ability to get intelligent query suggestions using a Large Language Model. The system understands both CLIP's and SD's strengths and can suggest effective search terms optimized for each model.</p> <h4 id=1-smart-query-generation>1. Smart Query Generation<a class=headerlink href=#1-smart-query-generation title="Permanent link">&para;</a></h4> <ul> <li>Users can input a general description of what they're looking for</li> <li>The LLM converts this into multiple optimized search terms for both models</li> <li>Each term comes with a suggested weight and model assignment</li> </ul> <p>For example, if a user inputs "I want to find impressionist paintings of people at the beach", the LLM might suggest:</p> <ul> <li>"People playing in the sand" (CLIP weight: 0.8)</li> <li>"Impressionist painting style" (Stable Diffusion weight: 0.9)</li> <li>"Beach activities" (CLIP weight: 0.7)</li> <li>"Loose brushwork texture" (Stable Diffusion weight: 0.6)</li> <li>"Sunny beach day" (CLIP weight: 0.4)</li> </ul> <h4 id=2-clip-aware-and-style-aware-formatting>2. CLIP-Aware and Style-Aware Formatting<a class=headerlink href=#2-clip-aware-and-style-aware-formatting title="Permanent link">&para;</a></h4> <ul> <li>Suggestions are formatted to match each model's strengths</li> <li>CLIP terms focus on concrete objects and scenes</li> <li>Stable Diffusion terms focus on artistic styles and techniques</li> <li>Balances specific and general descriptions</li> <li>Optimizes term combinations for hybrid search</li> </ul> <h4 id=3-interactive-refinement>3. Interactive Refinement<a class=headerlink href=#3-interactive-refinement title="Permanent link">&para;</a></h4> <ul> <li>Users can modify suggested weights</li> <li>Add or remove suggested terms</li> <li>Combine suggestions with their own queries</li> </ul> <h3 id=multi-model-search>Multi-Model Search<a class=headerlink href=#multi-model-search title="Permanent link">&para;</a></h3> <p>The hybrid search system allows users to leverage both models' strengths:</p> <h4 id=1-content-search-clip>1. Content Search (CLIP)<a class=headerlink href=#1-content-search-clip title="Permanent link">&para;</a></h4> <ul> <li>Object recognition</li> <li>Scene understanding</li> <li>Spatial relationships</li> <li>Action recognition</li> <li>Color and composition</li> </ul> <h4 id=2-style-search-stable-diffusion>2. Style Search (Stable Diffusion)<a class=headerlink href=#2-style-search-stable-diffusion title="Permanent link">&para;</a></h4> <ul> <li>Artistic techniques</li> <li>Visual styles</li> <li>Aesthetic qualities</li> <li>Texture recognition</li> <li>Artistic periods</li> </ul> <h4 id=3-location-awareness>3. Location Awareness<a class=headerlink href=#3-location-awareness title="Permanent link">&para;</a></h4> <ul> <li>Extracts GPS coordinates from EXIF data</li> <li>Handles location-based queries</li> <li>Combines with both CLIP and Stable Diffusion results</li> <li>Geographic clustering of similar styles</li> </ul> <p>For example, you could build a complex query:</p> <ul> <li>"Impressionist style" (Stable Diffusion weight: 0.8)</li> <li>"Garden scene" (CLIP weight: 0.7)</li> <li>"In France" (Location weight: 0.5)</li> <li>"With flowers" (CLIP weight: 0.6)</li> <li>"Monet-like brushstrokes" (Stable Diffusion weight: 0.4)</li> </ul> <h3 id=similar-image-finding>Similar Image Finding<a class=headerlink href=#similar-image-finding title="Permanent link">&para;</a></h3> <p>The "Find Similar" feature now considers both visual content and artistic style:</p> <h4 id=1-dual-similarity-analysis>1. Dual Similarity Analysis<a class=headerlink href=#1-dual-similarity-analysis title="Permanent link">&para;</a></h4> <ul> <li>Uses CLIP for content similarity</li> <li>Uses Stable Diffusion for style similarity</li> <li>Optional content-only mode</li> </ul> <h4 id=2-location-integration>2. Location Integration<a class=headerlink href=#2-location-integration title="Permanent link">&para;</a></h4> <ul> <li>Optional geographic distance filtering</li> <li>Finds stylistically similar images from nearby locations</li> <li>Useful for finding different artistic interpretations of the same location</li> </ul> <h4 id=3-combined-scoring>3. Combined Scoring<a class=headerlink href=#3-combined-scoring title="Permanent link">&para;</a></h4> <ul> <li>Weighted combination of CLIP and Stable Diffusion scores</li> <li>Location proximity factoring</li> <li>Customizable similarity thresholds</li> </ul> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>This powerful combination of technologies creates a search engine that understands images both semantically and aesthetically. The integration of CLIP and Stable Diffusion components allows for unprecedented control over content and style-based searches, while the location awareness and multi-query capabilities provide a complete solution for sophisticated image search.</p> <p>The system demonstrates how multiple AI models can work together to create intuitive and powerful tools for managing and exploring image collections. Whether you're an artist looking for stylistic inspiration, a photographer organizing your portfolio, or a researcher analyzing visual datasets, this system provides a sophisticated yet user-friendly solution.</p> <p>This is an impressive demonstration of rapid prototyping and iterative refinement working with AI tools to speed up development.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <ul> <li><a href=https://github.com/chris-thomas/image-searcher target=_blank>Github repo for this project</a></li> <li><a href=https://engineering.fb.com/2017/03/29/data-infrastructure/faiss-a-library-for-efficient-similarity-search/ target=_blank>FAISS article</a></li> <li><a href=https://github.com/facebookresearch/faiss target=_blank>FAISS repo</a></li> <li><a href=https://huggingface.co/spaces/stabilityai/stable-diffusion target=_blank>Stable Diffusion on Hugging Face</a></li> <li><a href=https://openai.com/index/clip/ target=_blank>CLIP</a></li> </ul> <p>P.S. Want to explore more AI insights together? Follow along with my latest work and discoveries here:</p> <!-- Subscribe to receive AI technical insights, news, and best practices: --> <p><a class=md-button href=https://chris-thomas.kit.com/33b5bb9175 target=_blank>Subscribe to Updates</a></p> <p><a class=md-button href=https://uk.linkedin.com/in/christhomasuk target=_blank>Connect with me on LinkedIn</a> </p> <p><a class=md-button href="https://twitter.com/intent/follow?screen_name=chris_thomas_uk" target=_blank>Follow me on X (Twitter)</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../01/26/how-to-sleep-soundly-when-using-llms-in-production-evals/ class="md-footer__link md-footer__link--prev" aria-label="Previous: How to sleep soundly when using LLMs in production: Evals!"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> How to sleep soundly when using LLMs in production: Evals! </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; Christopher Thomas </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://x.com/chris_thomas_uk target=_blank rel=noopener title=x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg> </a> <a href=https://www.linkedin.com/in/christhomasuk/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../../assets/javascripts/bundle.83f73b43.min.js></script> </body> </html>